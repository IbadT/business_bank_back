#!/bin/bash

# –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Kafka –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
# –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤—ã–ø–∏—Å–∫–∏

echo "=========================================="
echo "üöÄ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï KAFKA –ò–ù–¢–ï–ì–†–ê–¶–ò–ò"
echo "=========================================="
echo ""

# –ñ–¥–µ–º –ø–æ–∫–∞ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞..."
sleep 3

# URL —Å–µ—Ä–≤–∏—Å–∞
URL="http://localhost:8080/generate-statement"

# JSON –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞
JSON_DATA='{
  "accountId": "ACC_12345",
  "month": "2025-01",
  "businessType": "B2C",
  "initialBalance": 10000.50
}'

echo "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞: $URL"
echo ""
echo "üìã –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞:"
echo "$JSON_DATA" | jq '.'
echo ""
echo "=========================================="
echo ""

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
RESPONSE=$(curl -s -X POST "$URL" \
  -H "Content-Type: application/json" \
  -d "$JSON_DATA")

# –í—ã–≤–æ–¥–∏–º –æ—Ç–≤–µ—Ç
echo "üì• –û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:"
echo "$RESPONSE" | jq '.'
echo ""
echo "=========================================="
echo "‚úÖ –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!"
echo ""
echo "–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Docker:"
echo "  docker compose logs -f matematika"
echo ""
echo "–ò–ª–∏ –æ—Ç–∫—Ä–æ–π Kafdrop:"
echo "  http://localhost:9000"
echo "=========================================="

